<!DOCTYPE HTML>

<html>
	<head>
		<title>E-tube</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="html5/assets/css/main.css" />
		<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-storage.js"></script>
		<script src="googlelogin.js?useEmulator=true"></script>
		<script src="openPopup.js"></script>
<script>
function openWindowPop(url, name){
    var options = 'top=200, left=500, width=250, height=120, status=no, menubar=no, toolbar=no, resizable=no, fullscreen=no, location=no';
    window.open(url, name, options);
}

function resize(img){

   var width = img.width;
   var height = img.height;

   var maxWidth = 200;
   var maxHeight = 160;

   if(width > maxWidth || height > maxHeight){

      if(width > height){
         resizeWidth = maxWidth;
         resizeHeight = (height * resizeWidth) / width;

      }else{
         resizeHeight = maxHeight;
         resizeWidth = (width * resizeHeight) / height;
      }

   }else{
      resizeWidth = width;
      resizeHeight = height;
   }

   img.width = resizeWidth;
   img.height = resizeHeight;
}

function createDiv1(testid, name){
		var newSPAN = document.createElement("span");
		newSPAN.setAttribute("id", testid+"_span1");
		newSPAN.style.padding="0px 40px 40px 0px";
		document.getElementById("sec1").appendChild(newSPAN);

		var newA = document.createElement("a");
		newA.setAttribute("id", testid+"_a1");
		newA.setAttribute("href","channel_private.html?"+name);
		newA.setAttribute("class","test");
		document.getElementById(testid+"_span1").appendChild(newA);

		var newImg = document.createElement("img");
		newImg.setAttribute("id", testid+"_img");
		newImg.style.width="200px";
		newImg.style.height="160px";
		newImg.setAttribute("onload", "resize(this)");
		//newImg.style.display="block";
		document.getElementById(testid+"_a1").appendChild(newImg);
}

function createDiv2(testid, name){
		var newSPAN2 = document.createElement("span");
		newSPAN.setAttribute("id", testid+"_span2");
		newSPAN.style.padding="0px 40px 40px 0px";
		document.getElementById("sec2").appendChild(newSPAN2);

		var newA2 = document.createElement("a");
		newA.setAttribute("id", testid+"_a2");
		newA.setAttribute("href","channel_private.html?"+name);
		newA.setAttribute("class","test");
		document.getElementById(testid+"_span2").appendChild(newA2);

		var newImg2 = document.createElement("img");
		newImg.setAttribute("id", testid+"_img2");
		newImg.style.width="200px";
		newImg.style.height="160px";
		newImg.setAttribute("onload", "resize(this)");
		//newImg.style.display="block";
		document.getElementById(testid+"_a2").appendChild(newImg2);
}

function initApp(){
	// Listening for auth state changes.
	firebase.auth().onAuthStateChanged(function(user) {
			if (user) {
				var id = "test";
				var idnum =1;
				console.log("로그인 상태");
				name = user.displayName;
				email = user.email;
				photoUrl = user.photoURL;
				emailVerified = user.emailVerified;
				uid = user.uid;

				//temp = location.href.split("/");
				//temp1 = temp[5].split(".");
				//console.log(temp1[0]);
				var count =0;
				var dataRef = firebase.database().ref('/channel_List');
				dataRef.once('value', (snapshot)=>{
					try{
						snapshot.forEach((childSnapshot) => {
					var childKey = childSnapshot.key;
     			var childData = childSnapshot.val();
					createDiv1(id+(++idnum), childData.name);
					//createDiv2(id+(++idnum), childData.name);
					url = childData.imgpath;
					var img = document.getElementById(id+idnum+"_img");
					img.src = url;
					count++;
					if(count>=4)
					throw Break;
					});
				}catch(e){
					if(e!=Break) throw Break;
				}

				});

			} else {
					console.log("로그아웃 상태");

		}

	});

}

window.onload=function(){
	initApp();
}

</script>

<script>
/*
window.addEventListener("message", function(event){
	if(event.data=="logined"){
		alert("aesreajuie");
		var loginBtn = document.getElementById("loginBtn");
	  loginBtn.innerHTML = "로그아웃";
	}
});
*/
</script>

	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">

	<!-- Header -->
<div class="inner">
	<header id="header">
		<a href="index.html" class="logo"><h1>E-tube</h1> </a>

		<!-- Search -->
		<section id="search" class="alt">
			<form method="get" action="channel_select.html">
				<input type="text" name="query" id="query" placeholder="Search" />
			</form>
		</section>

		<ul class="icons">
			<li>
				<a href="javascript:openWindowPop('login.html', 'popup');" class="fa fa-user-circle fa-lg">
				<span id="loginBtn" class="label" style="color:#3D4449">
					<a id="logURL" href="javascript:openWindowPop('login.html', 'popup');">
						로그인
					</a>
					</span>
				<script>
				switch (localStorage.getItem("logined")) {
					case 'logined':
						document.getElementById("logURL").innerHTML="마이페이지";
						document.getElementById("logURL").setAttribute('href', 'mychannel.html');
						break;
					case '':
						document.getElementById("logURL").innerHTML="로그인";
						document.getElementById("logURL").setAttribute('href', "javascript:openWindowPop('login.html', 'popup');");
						break;
					default:

				}
				/*
				if(localStorage.getItem("logined") && localStorage.getItem("logouted")=='' ){
	          document.getElementById("logURL").innerHTML="마이페이지";
						document.getElementById("logURL").setAttribute('href', 'mychannel.html');

	        }
					if(localStorage.getItem("logouted") && localStorage.getItem("logined")==''){
	          document.getElementById("logURL").innerHTML="로그인";
						document.getElementById("logURL").setAttribute('href', "javascript:openWindowPop('login.html', 'popup');");
	        }
					*/
				</script>
			</a>
		</li>
		</ul>

	</header>



								<section id="sec1">

									<header class="major">
										<h2>인기 채널</h2>
									</header>
									<span style="float:right">
										<ul class="actions">
											<li><a href="#" class="button">더보기</a></li>
										</ul>
									</span>
									<!--
									<span style="padding:0px 40px 40px 0px">
										<a href="#" class="test"> <video src="C:\Users\hw\Desktop\고웹팀플자료\팀플용 이미지\CAT-1.mp4" width="200px" height="160px"
										controls loop></video> </a>
									</span>
									<span style="padding:0px 40px 40px 0px">
										<a href="#" class="test"> <video src="C:\Users\hw\Desktop\고웹팀플자료\팀플용 이미지\CAT-1.mp4" width="200px" height="160px"
										controls loop></video> </a>
									</span>
									<span style="padding:0px 40px 40px 0px">
										<a href="#" class="test"> <video src="C:\Users\hw\Desktop\고웹팀플자료\팀플용 이미지\CAT-1.mp4" width="200px" height="160px"
										controls loop></video> </a>
									</span>
									<span style="padding:0px 40px 40px 0px">
										<a href="#" class="test"> <video src="C:\Users\hw\Desktop\고웹팀플자료\팀플용 이미지\CAT-1.mp4" width="200px" height="160px"
										controls loop></video> </a>
									</span>
								-->


								</section>


							<!-- Section -->
							<section id="sec2">
								<header class="major">
									<h2>최근 채널</h2>
								</header>
								<span style="float:right">
									<ul class="actions">
										<li><a href="#" class="button">더보기</a></li>
									</ul>
								</span>
								<!--
								<span style="padding:0px 40px 40px 0px">
									<a href="#" class="test"> <video src="C:\Users\hw\Desktop\고웹팀플자료\팀플용 이미지\CAT-1.mp4" width="200px" height="160px"
									controls loop></video> </a>		poster="#" 하면 대표 이미지 선택
								</span>
								<span style="padding:0px 40px 40px 0px">
									<a href="#" class="test"> <video src="C:\Users\hw\Desktop\고웹팀플자료\팀플용 이미지\CAT-1.mp4" width="200px" height="160px"
									controls loop></video> </a>
								</span>
								<span style="padding:0px 40px 40px 0px">
									<a href="#" class="test"> <video src="C:\Users\hw\Desktop\고웹팀플자료\팀플용 이미지\CAT-1.mp4" width="200px" height="160px"
									controls loop></video> </a>
								</span>
								<span style="padding:0px 40px 40px 0px">
									<a href="#" class="test"> <video src="C:\Users\hw\Desktop\고웹팀플자료\팀플용 이미지\CAT-1.mp4" width="200px" height="160px"
									controls loop></video> </a>
								</span>
-->

							</section>



						</div>

					</div>


					<div id="sidebar">
				  <div class="inner">


				    <!-- Menu -->
				      <nav id="menu">
				        <header class="major">
				          <h2>카테고리</h2>
				        </header>
				        <ul>
				          <li>
				            <span class="opener">스포츠</span>
				            <ul>
				              <li><a href="categories/sports/basketball.html">농구</a></li>
				              <li><a href="categories/sports/baseball.html">야구</a></li>
				              <li><a href="categories/sports/football.html">축구</a></li>
				              <li><a href="categories/sports/swimming.html">수영</a></li>
				            </ul>
				          </li>
				          <li>
				            <span class="opener">음악</span>
				            <ul>
				              <li><a href="categories/music/piano.html">피아노</a></li>
				              <li><a href="categories/music/guitar.html">기타</a></li>
				              <li><a href="categories/music/flute.html">플룻</a></li>
				              <li><a href="categories/music/violin.html">바이올린</a></li>
				            </ul>
				          </li>
				          <li>
				            <span class="opener">생활</span>
				            <ul>
				              <li><a href="categories/lifestyle/cleaning.html">청소</a></li>
				              <li><a href="categories/lifestyle/saving.html">저축</a></li>
				              <li><a href="categories/lifestyle/cooking.html">요리</a></li>
				              <li><a href="categories/lifestyle/education.html">교육</a></li>
				            </ul>
				          </li>
				          <li>
				            <span class="opener">컴퓨터</span>
				            <ul>
				              <li><a href="categories/compter/web.html">웹프로그래밍</a></li>
				              <li><a href="categories/compter/db.html">데이터베이스</a></li>
				              <li><a href="categories/compter/data_com.html">데이터통신</a></li>
				              <li><a href="categories/compter/language.html">언어(자바/c++)</a></li>
				            </ul>
				          </li>
				          <li>
				            <span class="opener">게임</span>
				            <ul>
				              <li><a href="categories/game/lol.html">롤</a></li>
				              <li><a href="categories/game/fifa.html">피파</a></li>
				              <li><a href="categories/game/maplestory.html">메이플</a></li>
				              <li><a href="categories/game/cartrider.html">카트라이더</a></li>
				            </ul>
				          </li>
									<li><a href="studyboard.html">스터디게시판</a></li>
									<li><a href="specboard.html">스펙게시판</a></li>

				        </ul>
				      </nav>


						</div>
					</div>

			</div>




			<script>
			function search_channel() {
			var searchChannelName = document.getElementById("query").value;
			document.getElementById("select_channl_name").textContent = "chName";
			// var searchref = db.ref(value);

			firebase.database().ref("testsearch").startAt(searchChannelName).on("value",function(snapshot){
			if(snapshot.val() ) {
			var chName = snapshot.key;
			var chVideoNum = snapshot.val().videonum;
			var chSubscribe = snapshot.val().subscribe;
			var chImg = snapshot.val().channel_img_ref;
			var chLink = snapshot.val().channel_ref;

			//document.getElementById("select_channl_link").href = chLink ;
			//document.getElementById("select_channl_video").img = chImg;
			//document.getElementById("select_channl_name").textContent = chName;
			//document.getElementById("select_channl_videonum").textContent = "조회수 : "+ chVideoNum + " 구독자수 : "+ chSubscribe ;


			var channel_select_page =
			"<section>"
				"<div class=\"\" style=\" margin-left:8%; height: 250px; position:relative; \">"

					"<div class=\"image-container\" style=\"height: 210px; width: 280px; float:left; overflow:hidden; display:flex; align-items: center; justify-content: center; margin:20px\">"
						"<a href="+ chLink + " class=\"test\"> <img src="+ chImg + "></img> </a>"
					"</div>"
					"<div style=\"height: 210px; width: 400px; left:280px; width:30%; position:absolute;margin:20px;\">"
						"<a href="+ chLink + ">"
							"<h2 style=\"margin-top:40px; margin-left:15px\">"+ chName + "</h2>"
						"</a>"
						"<p style=\"margin-left:15px\"> 구독자수: " +chSubscribe + " 영상수: "+ chVideoNum + "<br>"
						"<a href=\"#\">채널주인스펙확인</a></p>"
					"</div>"

					"<div style=\"height: 210px; margin:20px; float:right; width:300px; width:20%\">"
						"<ul class=\"actions\" style=\"margin-top:85px;\" >"
							"<li><a href=\"#\" class=\"button\">구독</a></li>"
						"</ul>"
					"</div>"
				"</div>"
			"</section>";

			$(".inne").append(channel_select_page);

			}
			else {
			console.log("검색결과가 없습니다.");
			}

			} );
			}


			</script>



		<!-- Scripts 아직뭔지 모르겠음-->
			<script src="html5/assets/js/jquery_main.js"></script>
			<script src="html5/assets/js/browser_main.js"></script>
			<script src="html5/assets/js/breakpoints_main.js"></script>
			<script src="html5/assets/js/util.js"></script>
			<script src="html5/assets/js/main.js"></script>

	</body>
</html>
